{"version":3,"file":"live-edit-page-scripts-cf30975b.js","sources":["../../../src/PikseraPackages/LiveEdit/resources/js/ui/live-edit-page-scripts.js"],"sourcesContent":["\n\n\n\nif(window.self !== window.top) {\n\n    mw.require('liveedit.css');\n    mw.require('moveable.js');\n    //mw.require('options.js');\n\n\n    //mw.lib.require('tinymce');\n    mw.lib.require('jqueryui');\n\n    mw.liveEditSaveService = {\n        grammarlyFix: function (data) {\n\n            mw.$(\"grammarly-btn\", data).remove();\n            mw.$(\"grammarly-card\", data).remove();\n            mw.$(\"g.gr_\", data).each(function () {\n                mw.$(this).replaceWith(this.innerHTML);\n            });\n            mw.$(\"[data-gramm_id]\", data).removeAttr('data-gramm_id');\n            mw.$(\"[data-gramm]\", data).removeAttr('data-gramm');\n            mw.$(\"[data-gramm_id]\", data).removeAttr('data-gramm_id');\n            mw.$(\"grammarly-card\", data).remove();\n            mw.$(\"grammarly-inline-cards\", data).remove();\n            mw.$(\"grammarly-popups\", data).remove();\n            mw.$(\"grammarly-extension\", data).remove();\n            return data;\n        },\n        saving: false,\n        coreSave: function (data) {\n            if (!data) return false;\n            $.each(data, function () {\n                var body = mw.tools.parseHtml(this.html).body;\n                mw.liveEditSaveService.grammarlyFix(body);\n                mw.liveEditSaveService.animationsClearFix(body);\n                this.html = body.innerHTML;\n            });\n            mw.liveEditSaveService.saving = true;\n\n            /************  START base64  ************/\n            data.from_url = window.location.href;\n\n            //sometimes the url can be modified by pop state, so we use iframedata original url\n            if(typeof mw.liveEditIframeData !== 'undefined'){\n                if(typeof mw.liveEditIframeData.content_link !== 'undefined'){\n                    data.from_url =  mw.liveEditIframeData.content_link;\n                }\n            }\n\n\n            data = JSON.stringify(data);\n            data = btoa(encodeURIComponent(data).replace(/%([0-9A-F]{2})/g,\n                function toSolidBytes(match, p1) {\n                    return String.fromCharCode('0x' + p1);\n                }));\n            data = {data_base64: data};\n            /************  END base64  ************/\n\n            var xhr = mw.ajax({\n                type: 'POST',\n                url: mw.settings.api_url + 'save_edit',\n                data: data,\n                dataType: \"json\",\n                success: function (saved_data) {\n                    if (saved_data && saved_data.new_page_url && !mw.liveEditSaveService.DraftSaving) {\n                        window.mw.parent().askusertostay = false;\n                        window.mw.askusertostay = false;\n                        window.location.href = saved_data.new_page_url;\n\n                    }\n                }\n            });\n\n            xhr.always(function () {\n                mw.liveEditSaveService.saving = false;\n            });\n            return xhr;\n        },\n        parseContent: function (root) {\n            root = root || document.body;\n            var doc = mw.tools.parseHtml(root.innerHTML);\n            mw.$('.element-current', doc).removeClass('element-current');\n            mw.$('.element-active', doc).removeClass('element-active');\n            mw.$('.disable-resize', doc).removeClass('disable-resize');\n            mw.$('.mw-module-drag-clone', doc).removeClass('mw-module-drag-clone');\n            mw.$('.ui-draggable', doc).removeClass('ui-draggable');\n            mw.$('.ui-draggable-handle', doc).removeClass('ui-draggable-handle');\n            mw.$('.mt-ready', doc).removeClass('mt-ready');\n            mw.$('.mw-webkit-drag-hover-binded', doc).removeClass('mw-webkit-drag-hover-binded');\n            mw.$('.module-cat-toggle-Modules', doc).removeClass('module-cat-toggle-Modules');\n            mw.$('.mw-module-drag-clone', doc).removeClass('mw-module-drag-clone');\n            mw.$('.mce-edit-focus', doc).removeClass('mce-edit-focus');\n            mw.$('.mce-edit-body', doc).removeClass('mce-edit-body');\n            mw.$('[data-mce-style]', doc).removeAttr('data-mce-style');\n            mw.$('[mce-content-body]', doc).removeAttr('mce-content-body');\n            mw.$('[data-mce-style]', doc).removeAttr('data-mce-style');\n            mw.$('[data-mce-selected]', doc).removeAttr('data-mce-selected');\n            mw.$('[data-mce-href]', doc).removeAttr('data-mce-href');\n            mw.$('-module', doc).removeClass('-module');\n            mw.$('.empty-element', doc).remove();\n            mw.$('.empty-element', doc).remove();\n            mw.$('[data-mce-bogus]', doc).remove();\n            mw.$('.edit .ui-resizable-handle', doc).remove();\n            mw.$('script', doc).remove();\n            mw.$('.moveable-control-box', doc).remove();\n\n\n            //var doc = mw.$(doc).find('script').remove();\n\n            mw.tools.classNamespaceDelete('all', 'ui-', doc, 'starts');\n            mw.$(\"[contenteditable]\", doc).removeAttr(\"contenteditable\");\n            var all = doc.querySelectorAll('[contenteditable]'),\n                l = all.length,\n                i = 0;\n            for (; i < l; i++) {\n                all[i].removeAttribute('contenteditable');\n            }\n            var all = doc.querySelectorAll('.module'),\n                l = all.length,\n                i = 0;\n            for (; i < l; i++) {\n                if (all[i].querySelector('.edit') === null) {\n                    all[i].innerHTML = '';\n                }\n            }\n            return doc;\n        },\n        htmlAttrValidate: function (edits) {\n            var final = [];\n            $.each(edits, function () {\n                var html = this.outerHTML;\n                html = html.replace(/url\\(&quot;/g, \"url('\");\n                html = html.replace(/jpg&quot;/g, \"jpg'\");\n                html = html.replace(/jpeg&quot;/g, \"jpeg'\");\n                html = html.replace(/png&quot;/g, \"png'\");\n                html = html.replace(/gif&quot;/g, \"gif'\");\n                final.push($(html)[0]);\n            })\n            return final;\n        },\n        cleanUnwantedTags: function (body) {\n\n\n            mw.$('.mw-skip-and-remove,script', body).remove();\n            return body;\n        },\n        animationsClearFix: function (body) {\n            mw.$('[class*=\"animate__\"]').each(function () {\n                mw.tools.classNamespaceDelete(this, 'animate__');\n            });\n            return body;\n        },\n        collectData: function (edits) {\n            mw.$(edits).each(function () {\n                mw.$('meta', this).remove();\n                $('.mw-le-spacer', this).empty().removeAttr('data-resizable').removeAttr('style')\n            });\n\n            edits = this.htmlAttrValidate(edits);\n            var l = edits.length,\n                i = 0,\n                helper = {},\n                master = {};\n            if (l > 0) {\n                for (; i < l; i++) {\n                    helper.item = edits[i];\n                    var rel = mw.tools.mwattr(helper.item, 'rel');\n                    if (!rel) {\n                        mw.$(helper.item).removeClass('changed');\n                        mw.tools.foreachParents(helper.item, function (loop) {\n                            var cls = this.className;\n                            var rel = mw.tools.mwattr(this, 'rel');\n                            if (mw.tools.hasClass(cls, 'edit') && mw.tools.hasClass(cls, 'changed') && (!!rel)) {\n                                helper.item = this;\n                                mw.tools.stopLoop(loop);\n                            }\n                        });\n                    }\n                    var rel = mw.tools.mwattr(helper.item, 'rel');\n                    if (!rel) {\n                        var field = !!helper.item.id ? '#' + helper.item.id : '';\n                        console.warn('Skipped save: .edit' + field + ' element does not have rel attribute.');\n                        continue;\n                    }\n                    mw.$(helper.item).removeClass('changed orig_changed');\n                    mw.$(helper.item).removeClass('module-over');\n                    mw.$('.mw-le-ghost-layout', helper.item).remove();\n                    mw.$('#mw-non-existing-temp-element-holder', helper.item).remove();\n\n                    mw.$('.module-over', helper.item).each(function () {\n                        mw.$(this).removeClass('module-over');\n                    });\n\n\n                    mw.$('.element[data-mwplaceholder]', helper.item).each(function () {\n                        var isEmpty = !this.innerHTML.trim();\n                        if (!isEmpty) {\n                            mw.$(this).removeAttr('data-mwplaceholder');\n                        }\n\n                    });\n                    mw.$('.element.lipsum', helper.item).each(function () {\n                        mw.$(this).removeClass('lipsum');\n                    });\n\n                    mw.$('[data-mw-live-edithover]', helper.item).each(function () {\n                        mw.$(this).removeAttr('data-mw-live-edithover');\n                    });\n\n                    mw.$('[data-mw-temp-option-save]', helper.item).each(function () {\n                        mw.$(this).removeAttr('data-mw-temp-option-save');\n                    });\n                    mw.$('[class]', helper.item).each(function () {\n                        var cls = this.getAttribute(\"class\");\n                        if (typeof cls === 'string') {\n                            cls = cls.trim();\n                        }\n                        if (!cls) {\n                            this.removeAttribute(\"class\");\n                        }\n                    });\n                    var content = mw.liveEditSaveService.cleanUnwantedTags(helper.item).innerHTML;\n                    var attr_obj = {};\n                    var attrs = helper.item.attributes;\n                    if (attrs.length > 0) {\n                        var ai = 0,\n                            al = attrs.length;\n                        for (; ai < al; ai++) {\n                            attr_obj[attrs[ai].nodeName] = attrs[ai].nodeValue;\n                        }\n                    }\n                    var obj = {\n                        attributes: attr_obj,\n                        html: content\n                    };\n                    var objdata = \"field_data_\" + i;\n                    master[objdata] = obj;\n                }\n            }\n            return master;\n        },\n        getData: function (root) {\n            var body = mw.liveEditSaveService.parseContent(root).body,\n                edits = body.querySelectorAll('.edit.changed');\n            return mw.liveEditSaveService.collectData(edits);\n        },\n\n        saveDisabled: false,\n        draftDisabled: false,\n        save: function (data, success, fail) {\n            mw.trigger('beforeSaveStart', data);\n            // todo:\n\n            if (mw.top().app) {\n                if (mw.top().app && mw.top().app.cssEditor) {\n\n                    mw.top().app.cssEditor.publishIfChanged();\n                }\n            }\n\n            if (mw.top().app) {\n                if (mw.top().app && mw.top().options) {\n\n                    mw.top().options.publishTempOptions(document);\n                }\n            }\n            if (mw.liveEditSaveService.saveDisabled) {\n                return false;\n            }\n            if (!data) {\n                var body = mw.liveEditSaveService.parseContent().body,\n                    edits = body.querySelectorAll('.edit.changed');\n                data = mw.liveEditSaveService.collectData(edits);\n            }\n\n            var animations = (mw.__pageAnimations || []).filter(function (item) {\n                return item.animation !== 'none';\n            });\n\n            if (animations && animations.length > 0) {\n                var options = {\n                    group: 'template',\n                    key: 'animations-global',\n                    value: JSON.stringify(animations)\n                };\n\n                mw.top().options.saveOption(options);\n                // await new Promise(resolve =>  {\n                //     mw.options.saveOption(options, function(){\n                //         resolve();\n                //     });\n                // });\n            }\n\n\n            if (mw.tools.isEmptyObject(data)) {\n                if (success) {\n                    success.call({})\n                }\n                return false;\n            }\n\n\n            mw._liveeditData = data;\n\n            mw.trigger('saveStart', mw._liveeditData);\n\n            var xhr = mw.liveEditSaveService.coreSave(mw._liveeditData);\n            xhr.error(function (sdata) {\n\n                if (xhr.status == 403) {\n                    var modal = mw.dialog({\n                        id: 'save_content_error_iframe_modal',\n                        html: \"<iframe id='save_content_error_iframe' style='overflow-x:hidden;overflow-y:auto;' class='mw-modal-frame' ></iframe>\",\n                        width: $(window).width() - 90,\n                        height: $(window).height() - 90\n                    });\n\n                    mw.askusertostay = false;\n\n                    mw.$(\"#save_content_error_iframe\").ready(function () {\n                        var doc = document.getElementById('save_content_error_iframe').contentWindow.document;\n                        doc.open();\n                        doc.write(xhr.responseText);\n                        doc.close();\n                        var save_content_error_iframe_reloads = 0;\n                        doc = document.getElementById('save_content_error_iframe').contentWindow.document;\n\n                        mw.$(\"#save_content_error_iframe\").load(function () {\n                            // cloudflare captcha\n                            var is_cf = mw.$('.challenge-form', doc).length;\n                            save_content_error_iframe_reloads++;\n\n                            if (is_cf && save_content_error_iframe_reloads == 2) {\n                                setTimeout(function () {\n                                    mw.askusertostay = false;\n                                    mw.$('#save_content_error_iframe_modal').remove();\n                                }, 150);\n\n                            }\n                        });\n\n                    });\n                }\n                if (fail) {\n                    fail.call(sdata)\n                }\n            });\n            xhr.success(function (sdata) {\n                mw.$('.edit.changed').removeClass('changed');\n                mw.$('.orig_changed').removeClass('orig_changed');\n                if (document.querySelector('.edit.changed') !== null) {\n                    mw.liveEditSaveService.save();\n                } else {\n                    mw.askusertostay = false;\n                    mw.trigger('saveEnd', sdata);\n                }\n                if (success) {\n                    success.call(sdata)\n                }\n\n            });\n            xhr.fail(function (jqXHR, textStatus, errorThrown) {\n                mw.trigger('saveFailed', textStatus, errorThrown);\n                if (fail) {\n                    fail.call(sdata)\n                }\n            });\n            return xhr;\n        },\n\n    };\n\n    mw.saveLiveEdit = async () => {\n        return new Promise((resolve) => {\n            mw.liveEditSaveService.save(undefined, () => resolve(true), () => resolve(false));\n        })\n    };\n\n    mw.top().app.save = async () => {\n\n        return await mw.saveLiveEdit()\n    };\n\n\n    addEventListener('load', () => {\n\n        window.addEventListener('keydown', function (event) {\n            mw.top().app.canvas.dispatch('iframeKeyDown', {event})\n        });\n\n\n        mw.$('span.mw-powered-by').on(\"click\", function (e) {\n            mw.top().tools.open_global_module_settings_modal('white_label/admin', 'mw-powered-by');\n            return false;\n        });\n\n\n        const _handleEmptyEditFields = function () {\n\n            function manageNode(node) {\n                const isEmptyLike = !node.innerHTML.trim();\n\n                if (isEmptyLike && node.innerHTML.trim() === node.textContent.trim()) {\n                    // mw.element(node).append(`<p class=\"element\" data-mwplaceholder=\"${mw.lang(`This is sample text for your page`)}\"></p>`);\n                } else {\n                    node.classList[isEmptyLike ? 'add' : 'remove']('mw-le-empty-element');\n                }\n            }\n\n            document.querySelectorAll('.edit').forEach(function (node) {\n                if (!node.__$$_handleEmptyEditFields) {\n                    node.__$$_handleEmptyEditFields = true;\n                    manageNode(node);\n                    node.addEventListener('input', function () {\n                        manageNode(this);\n                    });\n                }\n            });\n\n            mw.top().app.on('editChanged', edit => {\n                setTimeout(() => manageNode(edit));\n            })\n        };\n\n        _handleEmptyEditFields()\n\n\n    });\n\n\n    let _beforeUnload = null;\n\n    mw.top().app.isNavigating = () => {\n        return !!_beforeUnload && _beforeUnload.returnValue && _beforeUnload.defaultPrevented === true\n    };\n\n\n    self.onbeforeunload = function (event) {\n        _beforeUnload = event;\n\n        // prevent user from leaving if there are unsaved changes\n         var liveEditIframe = self;\n\n       // var liveEditIframe = mw.top().app.canvas.getWindow();\n\n        liveEditIframe.mw.isNavigating = true;\n        if( typeof(mw.top) === 'function' && mw.top().app.canvas) {\n            mw.top().app.canvas.dispatch('liveEditCanvasBeforeUnload');\n        }\n\n        setTimeout(function (liveEditIframe) {\n            if (liveEditIframe) {\n                if (liveEditIframe && liveEditIframe.mw) {\n                    liveEditIframe.mw.isNavigating = false;\n                }\n            }\n        }, 1, liveEditIframe);\n\n\n        if (liveEditIframe\n            && liveEditIframe.mw && liveEditIframe.mw.askusertostay) {\n            return true;\n        } else {\n            if( typeof(mw.top) === 'function' && mw.top().app.canvas) {\n                var frame = mw.top().app.canvas.getFrame();\n                if (frame && frame.parentElement) {\n                    mw.top().spinner({element: frame.parentElement, decorate: true, size: 52}).show()\n                }\n            }\n        }\n    };\n\n\n    mw.drag = mw.drag || {};\n    mw.drag.save = function () {\n        return mw.liveEditSaveService.save();\n    };\n    mw.drag.fix_placeholders = function (isHard, selector) {\n        selector = selector || '.edit .row';\n\n        var more_selectors2 = 'div.col-md';\n        var a = mw.top().app.templateSettings.helperClasses.external_grids_col_classes;\n        var index;\n        for (index = a.length - 1; index >= 0; --index) {\n            more_selectors2 += ',div.' + a[index];\n        }\n        mw.$(selector).each(function () {\n            var el = mw.$(this);\n            el.children(more_selectors2).each(function () {\n                var empty_child = mw.$(this).children('*');\n                if (empty_child.size() == 0) {\n                    mw.$(this).append('<div class=\"element\" id=\"mw-element-' + mw.random() + '\">' + '</div>');\n                    var empty_child = mw.$(this).children(\"div.element\");\n                }\n            });\n        });\n\n    };\n\n    mw.drag.module_settings = function () {\n        var target = mw.top().app.liveEdit.moduleHandle.getTarget();\n        return mw.top().app.editor.dispatch('onModuleSettingsRequest', target);\n    };\n\n\n    document.documentElement.addEventListener('click', function (event) {\n\n        var target = event.target;\n        var link = mw.tools.firstParentOrCurrentWithTag(target, 'a');\n\n        if (link && link.href.indexOf('javascript:') !== 0 && !link.isContentEditable) {\n            const tmp = document.createElement('a');\n            tmp.href = link.href;\n            if (tmp.host !== location.host && (!link.target || link.target === '_self')) {\n                event.preventDefault();\n                open(link.href);\n            }\n        }\n\n    })\n    document.addEventListener('keydown', function (event) {\n        if (event.ctrlKey && event.keyCode === 83) {\n            return mw.top().app.editor.dispatch('Ctrl+S', event);\n        }\n    });\n\n\n    document.body.addEventListener('mouseenter', function (event) {\n        $('body').removeClass('mw-live-body-mouse-moved-outside');\n\n    });\n\n\n    document.body.addEventListener('mouseleave', function (event) {\n        $('body').addClass('mw-live-body-mouse-moved-outside');\n    });\n\n}\nif (self === top) {\n    window.addEventListener(\"load\", (event) => {\n        if (window.mwLiveEditIframeBackUrl) {\n            // Create the <a> element (button)\n            var stickyButton = document.createElement('a');\n            stickyButton.id = 'back-to-live-sticky-button';\n            stickyButton.textContent = 'Go Live Edit';\n            stickyButton.href = window.mwLiveEditIframeBackUrl;\n            stickyButton.classList.add('sticky');\n\n            // Append the button to the document body\n            document.body.appendChild(stickyButton);\n\n            // Apply sticky behavior\n            stickyButton.classList.add('sticky');\n\n\n\n            // Create and apply the CSS style dynamically\n            var style = document.createElement('style');\n            style.textContent = `\n                    #back-to-live-sticky-button {\n                        position: fixed;\n                        left: 50%;\n                        transform: translateX(-50%);\n                        z-index: 1001;\n                        transition: top 0.3s;\n                        background: #3498db;\n                        color: #fff !important;\n                        padding: 10px 20px;\n                        border-radius: 5px;\n                        border-top-left-radius: 0;\n                        border-top-right-radius: 0;\n                        font-family: Arial, sans-serif;\n                        border: none;\n                        box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);\n                        cursor: pointer;\n                    }\n\n                    #back-to-live-sticky-button:hover {\n                        background: #2980b9;\n                    }\n\n\n                    #back-to-live-sticky-button.sticky {\n                        top: 0;\n                    }\n\n\n\n\n            `;\n\n            document.head.appendChild(style);\n        }\n\n        // todo: remove\n        document.querySelectorAll('.no-select [class*=\"col\"]').forEach(function(node){\n            if(Array.from(node.children).filter(c => c.classList.contains('element')).length) {\n                node.classList.add('allow-select')\n            }\n        });\n    });\n}\n\n\n\n"],"names":["data","body","match","p1","xhr","saved_data","root","doc","all","l","edits","final","html","i","helper","master","rel","loop","cls","field","isEmpty","content","attr_obj","attrs","ai","al","obj","objdata","success","fail","animations","item","options","sdata","save_content_error_iframe_reloads","is_cf","jqXHR","textStatus","errorThrown","resolve","event","e","manageNode","node","isEmptyLike","edit","_beforeUnload","liveEditIframe","frame","isHard","selector","more_selectors2","a","index","el","empty_child","target","link","tmp","stickyButton","style","c"],"mappings":"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"}